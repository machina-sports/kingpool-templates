workflow:
  name: "workflow-install-documents"
  title: "Install Documents"
  description: "Workflow to install documents."
  outputs:
    setup-register: "$.get('setup-register')"
    workflow-status: "$.get('setup-register') is True and 'skipped' or 'executed'"
  tasks:

    - type: "document"
      name: "load-setup-register"
      description: "Search for setup-register"
      config:
        action: "search"
        search-limit: 1
        search-vector: false
      inputs:
        name: "'setup-register'"
      outputs:
        setup-register: "$.get('documents')[0].get('value').get('setup', False) if $.get('documents') else False"

    # documents-structure
    - type: "document"
      name: "install-documents"
      description: "Install documents."
      condition: "$.get('setup-register') is not True"
      config:
        action: "update"
        embed-vector: false
        force-update: true
      documents:
        setup-register: |
          {
            "setup": True
          }
        site-structure: |
          [
            {
              "title": "Producer Dashboard",
              "isActive": True,
              "target": "_blank",
              "icon": "globe",
              "url": "https://dazn-moderator.machina.gg/"
            },
            {
              "title": "Site Aposta Genial",
              "isActive": True,
              "target": "_blank",
              "icon": "globe",
              "url": "https://www.apostagenial.com.br/"
            },
            {
              "title": "Site Gameday",
              "isActive": True,
              "target": "_blank",
              "icon": "globe",
              "url": "https://gameday-sportingbet.dev-stage.machina.gg/"
            },
            {
              "title": "Site Sportingbet",
              "isActive": True,
              "target": "_blank",
              "icon": "globe",
              "url": "https://sportingbet.machina.gg/"
            }
          ]
        doc-structure: |
          [
            {
              "title": "Catalogue",
              "isActive": True,
              "icon": "folder",
              "items": [
                {
                  "name": "competitions",
                  "title": "Competitions",
                  "category": "Catalogue",
                  "metadata": {
                    "name": ["competitions","competition"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "events-live",
                  "title": "Events Live",
                  "category": "Catalogue",
                  "filters": {
                    "value.sport_event_status.status": "live"
                  },
                  "metadata": {
                    "name": ["schedule"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "favorite-events",
                  "title": "Favorites",
                  "category": "Catalogue",
                  "filters": {
                    "value.is_favorite": True
                  },
                  "metadata": {
                    "name": ["schedule"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "seasons",
                  "title": "Seasons",
                  "category": "Catalogue",
                  "metadata": {
                    "name": ["seasons","season"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "schedules",
                  "title": "Schedules",
                  "category": "Catalogue",
                  "metadata": {
                    "name": ["schedules","schedule"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "standings",
                  "title": "Standings",
                  "category": "Catalogue",
                  "metadata": {
                    "name": ["standings","standing"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "probabilities",
                  "title": "Probabilities",
                  "category": "Catalogue",
                  "metadata": {
                    "name": ["probabilities"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                }
              ]
            },
            {
              "title": "Completion",
              "isActive": True,
              "icon": "folder",
              "items": [
                {
                  "name": "completion-messages",
                  "title": "Messages",
                  "category": "Completion",
                  "metadata": {
                    "name": ["message"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                }
              ]
            },
            {
              "title": "Content",
              "isActive": True,
              "icon": "folder",
              "items": [
                {
                  "name": "content-briefing",
                  "title": "Briefing",
                  "category": "Content",
                  "metadata": {
                    "name": ["content-briefing"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "blog-content",
                  "title": "Content",
                  "category": "Content",
                  "metadata": {
                    "name": ["blog-content"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "content-news",
                  "title": "News",
                  "category": "Content",
                  "metadata": {
                    "name": ["content-news"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "content-polls",
                  "title": "Polls",
                  "category": "Content",
                  "metadata": {
                    "name": ["content-poll"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "content-quizzes",
                  "title": "Quizzes",
                  "category": "Content",
                  "metadata": {
                    "name": ["content-quiz"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "content-snippets",
                  "title": "Snippets",
                  "category": "Content",
                  "metadata": {
                    "name": ["content-snippet"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "content-standings",
                  "title": "Standings",
                  "category": "Content",
                  "metadata": {
                    "name": ["blog-standings", "content-standings"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "blog-summary",
                  "title": "Summary",
                  "category": "Content",
                  "metadata": {
                    "name": ["event-summary"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                }
              ]
            },
            {
              "title": "Exchange",
              "isActive": True,
              "icon": "folder",
              "items": [
                {
                  "name": "exchange-mappings",
                  "title": "Mappings",
                  "category": "Exchange",
                  "metadata": {
                    "name": ["exchange-map", "exchange-mappings"]
                  },
                  "view": "list"
                },
                {
                  "name": "exchange-markets",
                  "title": "Markets",
                  "category": "Exchange",
                  "metadata": {
                    "name": ["exchange-markets", "exchange-market"]
                  },
                  "view": "list"
                },
                {
                  "name": "exchange-prices",
                  "title": "Prices",
                  "category": "Exchange",
                  "metadata": {
                    "name": ["exchange-prices", "exchange-price"]
                  },
                  "view": "list"
                },
                {
                  "name": "exchange-runners",
                  "title": "Runners",
                  "category": "Exchange",
                  "metadata": {
                    "name": ["exchange-runners", "exchange-runner"]
                  },
                  "view": "list"
                }
              ]
            }
          ]
