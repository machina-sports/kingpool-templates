workflow:
  name: "populate-folders"
  title: "Setup Folders"
  description: "Setup Folders"
  inputs:
    force-setup: "$.get('force-setup') == 'true'"
  outputs:
    setup-register: "$.get('setup-register')"
    workflow-status: "($.get('setup-register') is True or $.get('force-setup') is True) and 'skipped' or 'executed'"
  tasks:

    # load-setup-register
    - type: "document"
      name: "load-setup-register"
      description: "Search for setup-register"
      config:
        action: "search"
        search-limit: 1
        search-vector: false
      inputs:
        name: "'setup-register'"
      outputs:
        setup-register: "$.get('documents')[0].get('value').get('setup', False) if $.get('documents') else False"

    # documents-structure
    - type: "document"
      name: "install-documents"
      description: "Install documents."
      condition: "$.get('setup-register') is not True or $.get('force-setup') is True"
      config:
        action: "update"
        embed-vector: false
        force-update: true
      documents:
        setup-register: |
          {
            "setup": True
          }
        site-structure: |
          []
        doc-structure: |
          [
            {
              "title": "Catalogue",
              "isActive": True,
              "icon": "folder",
              "items": [
                {
                  "name": "competitions",
                  "title": "NBA Competitions",
                  "description": "The NBA competitions available in the Sportradar API.",
                  "category": "Catalogue",
                  "metadata": {
                    "name": ["competitions", "competition", "seasons", "season"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                },
                {
                  "name": "schedules",
                  "title": "NBA Game Schedule",
                  "description": "The NBA schedules synced from the Sportradar API.",
                  "category": "Catalogue",
                  "metadata": {
                    "name": ["nba-game", "nba-games", "schedules", "schedule"]
                  },
                  "sorters": ['_id', -1],
                  "view": "list"
                }
              ]
            },
            {
              "title": "Reporter",
              "isActive": True,
              "icon": "folder",
              "items": [
                {
                  "name": "reporter-articles",
                  "title": "NBA Articles",
                  "description": "The NBA articles generated by the AI Reporter.",
                  "category": "Reporter",
                  "metadata": {
                    "name": ["content-article", "content-articles"]
                  },
                },
                {
                  "name": "reporter-briefings",
                  "title": "NBA Briefings",
                  "description": "The NBA briefings generated by the AI Reporter.",
                  "category": "Reporter",
                  "metadata": {
                    "name": [
                      "comparison-analysis",
                      "standings-analysis",
                      "team-history",
                      "team-news"
                    ]
                  },
                  "sorters": ['_id', -1],
                  "view": "grid"
                },
                {
                  "name": "reporter-images",
                  "title": "NBA Images",
                  "description": "The NBA images generated by the AI Reporter.",
                  "category": "Reporter",
                  "metadata": {
                    "name": ["image-document"]
                  },
                },
                {
                  "name": "reporter-snippets",
                  "title": "NBA Snippets",
                  "description": "The NBA snippets generated by the AI Reporter.",
                  "category": "Reporter",
                  "metadata": {
                    "name": ["content-snippet", "reporter-snippet"]
                  },
                  "sorters": ['_id', -1],
                  "view": "grid"
                }
              ]
            }
          ] 
